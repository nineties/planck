===============
Instruction Set
===============

Non-Branch Instructions
=======================

::

   +------+----------+-----------------+------------------------------+
   | name | 1st byte | following bytes |                              |
   +======+==========+=================+==============================+
   | nop  | 00000000 |                 | do nothing                   |
   +------+----------+-----------------+------------------------------+
   | phi  | 00000001 | see below       | lhs = phi(...)               |
   +------+----------+-----------------+------------------------------+
   | move | 00000010 | lhs,rhs         | lhs = rhs                    |
   +------+----------+-----------------+------------------------------+
   | add  | 00000011 | lhs,arg0,arg1   | lhs = arg0 + arg1            |
   +------+----------+-----------------+------------------------------+
   | sub  | 00000100 | lhs,arg0,arg1   | lhs = arg0 - arg1            |
   +------+----------+-----------------+------------------------------+
   | mul  | 00000101 | lhs,arg0,arg1   | lhs = arg0 * arg1            |
   +------+----------+-----------------+------------------------------+
   | div  | 00000110 | lhs,arg0,arg1   | lhs = arg0 / arg1            |
   +------+----------+-----------------+------------------------------+

Phi instruction::

   Phi instruction is a special purpose instruction used in SSA form.
   The semantics of

   lhs = phi(i0:rhs0, i1:rhs1, ...)

   is that when the index of preceding basic block is i0, the value of lhs is
   rhs0 and so on.

   +----------+~~~~~+~~~~~~~~~~+~~~~~~~~~~~~~~~~~+
   | 00000001 | lhs | uint (n) | n x (uint, rhs) |
   +----------+~~~~~+~~~~~~~~~~+~~~~~~~~~~~~~~~~~+

Branch Instructions
===================

::

   +---------------+----------+-----------------+------------------------------+
   | name          | 1st byte | following bytes |                              |
   +===============+==========+=================+==============================+
   | goto          | 10000000 | uint(i)         | do nothing, proceed to the   |
   |               |          |                 | basic block i.               |
   +---------------+----------+-----------------+------------------------------+
   | return        | 10000001 | operand         | return from function         |
   +---------------+----------+-----------------+------------------------------+
